---
title: Unidad 7
unitId: unit7
---

import { Aside } from '@astrojs/starlight/components';

## IntroducciÃ³n ğŸ“œ

En unidades anteriores, exploraste cÃ³mo conectar un dispositivo fÃ­sico (micro:bit) a 
una aplicaciÃ³n web usando Web Serial y tambiÃ©n cÃ³mo conectar dos ventanas del navegador 
en tu propio computador usando Node.js y Socket.IO.

Ahora, daremos un paso mÃ¡s allÃ¡ en la conectividad. Usaremos un dispositivo que llevas 
contigo a todas partes, tu **telÃ©fono celular**, como un dispositivo de entrada. 
Capturaremos los eventos tÃ¡ctiles (*touch*) en una pÃ¡gina web simple en tu celular y 
enviaremos esa informaciÃ³n en tiempo real a una aplicaciÃ³n p5.js, que se ejecutarÃ¡ 
en el navegador de tu **computador**.

Para lograr este "puente" entre dispositivos, utilizaremos Node.js y Socket.IO como 
servidor intermediario, similar a la unidad anterior. Sin embargo, como tu celular 
y tu computador no estarÃ¡n (inicialmente) en la misma red local o no podrÃ¡n "verse" 
directamente, introduciremos una herramienta poderosa: **Microsoft Dev Tunnels** 
(accesible a travÃ©s de VS Code) para exponer de forma segura nuestro servidor 
local a Internet.

## Set: Â¿QuÃ© aprenderÃ¡s en esta unidad? ğŸ’¡

Al finalizar esta unidad, serÃ¡s capaz de:

- Configurar y utilizar **VS Code Port Forwarding (Dev Tunnels)** para exponer un servidor 
Node.js local a Internet de forma segura.
- Implementar una aplicaciÃ³n cliente en un dispositivo mÃ³vil (telÃ©fono) que capture 
**eventos tÃ¡ctiles** y los envÃ­e a un servidor Node.js usando Socket.IO.
- Implementar una aplicaciÃ³n cliente en un computador de escritorio que reciba datos 
en tiempo real desde el servidor Node.js (originados en el mÃ³vil) y los utilice para 
controlar una visualizaciÃ³n p5.js.
- Utilizar **JSON** para estructurar y transmitir datos complejos 
(coordenadas tÃ¡ctiles) entre cliente y servidor.
- Analizar y comprender el flujo completo de datos: MÃ³vil (Touch) -> Servidor Node.js (vÃ­a Dev Tunnel) -> Escritorio (VisualizaciÃ³n).
- Crear tu propia aplicaciÃ³n interactiva que conecte un dispositivo mÃ³vil y un computador 
usando las tecnologÃ­as aprendidas.

### Actividad 01

:::note[ğŸ¯ Enunciado]
Vamos a configurar y ejecutar el caso de estudio base. El objetivo es lograr que la interacciÃ³n tÃ¡ctil en una pÃ¡gina web 
abierta en tu **celular** controle en tiempo real un cÃ­rculo en una pÃ¡gina web abierta en el navegador de tu **computador**. 
Usaremos Node.js como intermediario y VS Code Dev Tunnels para hacer posible la conexiÃ³n entre ambas aplicaciones.
:::

:::danger[âš ï¸ Advertencia]
En la unidad anterior usaste node.js para realizar el puente entre dos aplicaciones. En esta unidad 
usaremos el mismo concepto, pero ahora necesitas una herramienta adicional: **Dev Tunnels**. Â¿Por quÃ©?
Al terminar esta unidad verifica que tienes clara la respuesta a esta pregunta.
:::

:::tip[Recursos]
- CÃ³digo fuente del caso de estudio (`server.js`, carpeta `public` con subcarpetas `desktop` y `mobile`). El 
caso de estudio lo puedes encontrar [aquÃ­](https://github.com/juanferfranco/sfiSocketioDesktopMobile).
- [Node.js](https://nodejs.org/en) instalado en tu computador.
- [Visual Studio Code](https://code.visualstudio.com/) instalado en tu computador.
- Tu telÃ©fono celular con un navegador web moderno (Chrome, Safari, Firefox).
- ConexiÃ³n a internet tanto en el computador como en el celular.
:::

ğŸ‘£ **Pasos**:

1.  **Prepara el proyecto:**
    *   Descarga o clona el cÃ³digo del caso de estudio en tu computador. El cÃ³digo estÃ¡ en 
    [este](https://github.com/juanferfranco/sfiSocketioDesktopMobile) repositorio.
    *   Abre una terminal en la carpeta raÃ­z del proyecto.
    *   Ejecuta `npm install` para instalar las dependencias (`express`, `socket.io`). Haz esto solo la primera vez.
2.  **Inicia el servidor local:**
    *   Abre la carpeta del proyecto en VS Code.
    *   Abre una terminal integrada en VS Code (View > Terminal).
    *   En la terminal, ejecuta `npm start`.
    *   DeberÃ­as ver el mensaje: `Server is listening on http://localhost:3000`. Â¡Pero aÃºn no accedas a esa URL!
3.  **ExpÃ³n el servidor con Dev Tunnels:**
    *   Selecciona PORTS. Click en Forward a Port (Dev Tunnels).
    *   En el nÃºmero de puerto, selecciona `3000` (Â¿Por quÃ© este?)
    *   En la columna Visibility, selecciona `Public`. Esto permitirÃ¡ que el tÃºnel sea accesible desde cualquier lugar.
    *   Copia la URL que aparece en la columna Forwarded Address. Esta URL es la que usarÃ¡s para acceder al servidor 
        desde tu celular.
    *   EnvÃ­a esta URL a tu celular. Se verÃ¡ algo como `https://TU-TENDRAS-UNA-DIFERNTE.use2.devtunnels.ms/`.
4.  **Accede a las aplicaciones:**
    *   **En tu Computador:** abre un navegador web y ve a la URL: `http://localhost:3000/desktop/`. DeberÃ­as ver el canvas de p5.js con un cÃ­rculo rojo.
    *   **En tu Celular:** abre un navegador web y ve a la URL que enviaste pero aÃ±adiendo /mobile/ al final. Algo asÃ­ como esto:  `https://TU-TENDRAS-UNA-DIFERNTE.use2.devtunnels.ms//mobile/` (AsegÃºrate de aÃ±adir `/mobile/` al final). DeberÃ­as ver el canvas de p5.js con el texto "Touch to move the circle".
6.  **Prueba la interacciÃ³n:**
    *   Toca y mueve el dedo sobre la pantalla de tu **celular**.
    *   Observa el navegador de tu **computador**. El cÃ­rculo rojo deberÃ­a moverse siguiendo tu dedo.
    *   Observa la terminal donde corre `server.js`. DeberÃ­as ver mensajes "New client connected", "Received message => ...", y "Client disconnected" cuando cierras las pestaÃ±as.
7.  **Cierra el Port**: una vez termines de hacer las pruebas **NO OLVIDES CERRAR** el puerto.
8.  **Â¿Si cerraste el puerto?**

:::note[ğŸ§ğŸ§ªâœï¸ Reporta en tu bitÃ¡cora]
- Â¿QuÃ© URL de Dev Tunnels obtuviste? Â¿Por quÃ© crees que necesitamos usar esta URL en lugar de `http://localhost:3000` o 
la IP local de tu computador para que el celular se conecte?
- Describe brevemente quÃ© hace `npm install` y `npm start`.
- Â¿QuÃ© mensajes observaste en la terminal del servidor al conectar el cliente de escritorio y el cliente mÃ³vil? Â¿Eran diferentes los mensajes o identificadores?
- Describe el comportamiento observado: Â¿FuncionÃ³ la interacciÃ³n? Â¿Hubo algÃºn retraso (latencia)?
:::

## Seek: InvestigaciÃ³n ğŸ”

<Aside type="note" title="Caso de estudio">
Ahora que has configurado y probado el sistema base, es hora de sumergirnos en los 
detalles. Desglosaremos los componentes clave: los conceptos nuevos necesarios, el servidor 
Node.js que actÃºa como puente, el cliente mÃ³vil que captura el *touch*, y el cliente de 
escritorio que recibe y visualiza.
</Aside>

### Actividad 02

:::note[ğŸ¯ Enunciado]
Antes de analizar el cÃ³digo lÃ­nea por lÃ­nea, vamos a clarificar los conceptos *nuevos* o *crÃ­ticos* 
especÃ­ficos de esta unidad que permiten la comunicaciÃ³n entre tu celular y tu computador a travÃ©s de Internet.
:::

:::tip[Recursos]
- DocumentaciÃ³n de [VS Code Dev Tunnels](https://code.visualstudio.com/docs/debugtest/port-forwarding) (para profundizar).
- Referencia de p5.js sobre eventos tÃ¡ctiles: [`touchMoved()`](https://p5js.org/reference/p5/touchMoved/).
- Tu cÃ³digo del caso de estudio.
:::

ğŸ‘£ **Pasos**: (ExplicaciÃ³n conceptual)

1.  **El problema de la conexiÃ³n directa:**
    *   Cuando ejecutas `npm start`, el servidor escucha en `localhost:3000`. `localhost` (o `127.0.0.1`) es una direcciÃ³n especial que *siempre* se refiere a tu propia mÃ¡quina.
    *   Si intentaras acceder a `http://localhost:3000` desde tu celular, este buscarÃ­a un servidor *en el propio celular*, no en tu computador.
    *   PodrÃ­as usar la IP local de tu computador (ej. `192.168.1.X`), pero esto solo funciona si ambos dispositivos estÃ¡n en la *misma red Wi-Fi* y no hay firewalls bloqueando. No funcionarÃ­a si tu celular usa datos mÃ³viles o estÃ¡ en otra red.
    *   **Necesitamos una direcciÃ³n pÃºblica y accesible desde cualquier lugar.**

2.  **La soluciÃ³n: VS Code Dev Tunnels (Port Forwarding):**
    *   Dev Tunnels actÃºa como un **intermediario seguro**. Crea un tÃºnel desde una URL pÃºblica en Internet (la que obtuviste, como `https://TU-TENDRAS-UNA-DIFERNTE.use2.devtunnels.ms/`) hasta el puerto `3000` de tu `localhost`.
    *   Cuando tu celular (o cualquier cliente en Internet) se conecta a la URL pÃºblica de Dev Tunnels, el servicio de Dev Tunnels reenvÃ­a esa conexiÃ³n de forma segura a travÃ©s del tÃºnel hasta tu servidor Node.js local.
    *   Del mismo modo, las respuestas de tu servidor local viajan de vuelta por el tÃºnel hasta el servicio Dev Tunnels, que las entrega al cliente (celular/escritorio).
    *   **AnalogÃ­a:** Es como tener un nÃºmero de telÃ©fono pÃºblico (la URL de Dev Tunnels) que redirige las llamadas a tu telÃ©fono privado en casa (`localhost:3000`), sin exponer directamente tu nÃºmero privado.

3.  **Capturando la entrada: eventos tÃ¡ctiles en p5.js (`mobile/sketch.js`):**
    *   p5.js ofrece funciones especÃ­ficas que se ejecutan automÃ¡ticamente cuando ocurren eventos tÃ¡ctiles en un dispositivo mÃ³vil (o simulaciÃ³n en escritorio).
    *   **`touchMoved()`:** es la funciÃ³n clave aquÃ­. Se llama *continuamente* mientras el usuario mantiene un dedo presionado y lo mueve sobre el canvas. Dentro de esta funciÃ³n, `mouseX` y `mouseY` contienen las coordenadas actuales del toque.
    *   **OptimizaciÃ³n (`threshold`):** el cÃ³digo no envÃ­a un mensaje en *cada* pequeÃ±o movimiento detectado por `touchMoved()`. Comprueba si el movimiento desde la Ãºltima vez que se enviÃ³ (`lastTouchX`, `lastTouchY`) supera un 
    umbral (`threshold`). Esto evita inundar la red con mensajes si el dedo tiembla o se mueve mÃ­nimamente, enviando solo cambios significativos.
    *   Otras funciones Ãºtiles (no usadas en este caso base, pero relevantes):
        *   `touchStarted()`: se llama una vez cuando el usuario toca la pantalla por primera vez.
        *   `touchEnded()`: se llama una vez cuando el usuario levanta el dedo de la pantalla.

:::note[ğŸ§ğŸ§ªâœï¸ Reporta en tu bitÃ¡cora]
- Explica con tus propias palabras: Â¿Por quÃ© es necesario Dev Tunnels en este escenario y cÃ³mo funciona conceptualmente?
- Describe la funciÃ³n de `touchMoved()` y por quÃ© se usa la variable `threshold` en el cliente mÃ³vil.
- Compara brevemente Dev Tunnels con simplemente usar la IP local. Â¿CuÃ¡les son las ventajas y desventajas de cada uno?
- Coloca en tu bitÃ¡cora capturas de pantalla del sistema completo funcionando. Esto lo puedes hacer abriendo tanto el mobile 
como el desktop en tu computador y tomando una captura de pantalla de todos los involucrados (celular, computador y terminal).
:::

### Actividad 03

:::note[ğŸ¯ Enunciado]
Vamos a analizar el cÃ³digo `server.js`. Este script actÃºa como un repetidor simple 
pero esencial, recibiendo mensajes del cliente mÃ³vil y retransmitiÃ©ndolos al cliente de escritorio.
:::


:::note[ğŸ§ğŸ§ªâœï¸ Reporta en tu bitÃ¡cora]

- Â¿CuÃ¡l es la funciÃ³n principal de express.static('public') en este servidor? Â¿CÃ³mo se compara con el uso de app.get('/ruta', ...) del servidor de la Unidad 6?

- Explica detalladamente el flujo de un mensaje tÃ¡ctil: Â¿QuÃ© evento lo envÃ­a desde el mÃ³vil? Â¿QuÃ© evento lo recibe el servidor? Â¿QuÃ© hace el servidor con Ã©l? 
Â¿QuÃ© evento lo envÃ­a el servidor al escritorio? Â¿Por quÃ© se usa socket.broadcast.emit en lugar de io.emit o socket.emit en este caso?

- Si conectaras dos computadores de escritorio y un mÃ³vil a este servidor, y movieras el dedo en el mÃ³vil, Â¿QuiÃ©n recibirÃ­a el mensaje retransmitido por el servidor? Â¿Por quÃ©?

- Â¿QuÃ© informaciÃ³n Ãºtil te proporcionan los mensajes console.log en el servidor durante la ejecuciÃ³n?
:::

### Actividad 04

:::note[ğŸ¯ Enunciado]
Ahora analizaremos el cÃ³digo que corre en los navegadores: el cliente mÃ³vil que captura el toque (`mobile/sketch.js`) y el cliente de escritorio que recibe la informaciÃ³n 
y dibuja (`desktop/sketch.js`). Veremos cÃ³mo usan Socket.IO para comunicarse con el servidor.
:::


:::note[ğŸ§ğŸ§ªâœï¸ Reporta en tu bitÃ¡cora]
Realiza un diagrama donde muestres el flujo completo de datos y eventos entre los tres componentes: mÃ³vil, servidor y escritorio. Puedes ilustrar 
con un ejemplo de coordenadas tÃ¡ctiles (x, y) y cÃ³mo viajan a travÃ©s del sistema.
:::

## Apply: AplicaciÃ³n ğŸ› 

<Aside type="note" title=" ">
Has analizado cÃ³mo el mÃ³vil puede controlar el escritorio a travÃ©s de un servidor 
y Dev Tunnels. Ahora es tu turno de ser creativo. TomarÃ¡s la base tecnolÃ³gica y crearÃ¡s 
una aplicaciÃ³n interactiva diferente, manteniendo la esencia: el *touch* del mÃ³vil como input 
principal.
</Aside>

### Actividad 05

#### Aplica lo aprendido

:::note[ğŸ¯ Enunciado]
Ahora que comprendes cÃ³mo funciona el sistema base, es tu turno de **CREAR**
:::

:::note[ğŸ§ğŸ§ªâœï¸ Reporta en tu bitÃ¡cora]
1. DiseÃ±a una aplicaciÃ³n interactiva que use el *touch* del mÃ³vil para controlar una visuales de tema musical 
de tu elecciÃ³n. Las visuales correrÃ¡n en una aplicaciÃ³n de escritorio (desktop). Recuerda que ambas aplicaciones 
las construirÃ¡s usando p5.js y utilizando el servidor Node.js como puente.
2. Implementa tu diseÃ±o. Puedes usar IA generativa para ayudarte a escribir el cÃ³digo, pero primero debes hacer 
el diseÃ±o de lo que quieres.
3. Incluye todos los cÃ³digos (servidor y clientes) en tu bitÃ¡cora.
:::

## Evidencias ğŸ—‚ï¸

<Aside type="note" title="RUBRICA!">
* Recuerda que la bitÃ¡cora se cierra 10 minutos antes de la segunda sesiÃ³n de la semana 2 de la unidad. 
* Si no realizas la autoevaluaciÃ³n tu nota serÃ¡ 0.
* Si una actividad no estÃ¡ COMPLETA debes multiplicar la nota de esa actividad por el porcentaje 
de avance que tengas.
* Para la actividad de aplicaciÃ³n podrÃ¡s usar IA generativa, PERO SOLO para generar el cÃ³digo Y CON LA 
condiciÃ³n de primero realizar el **DISEÃ‘O** de lo que quieres.

**RÃºbrica de evaluaciÃ³n del proceso**

5: realicÃ© las 5 actividades completas y la autoevaluaciÃ³n.  
3: realicÃ© 4 actividades completas y la autoevaluaciÃ³n.  
2: realicÃ© 3 actividades completas y la autoevaluaciÃ³n.  
1: realicÃ© 2 actividades completas y la autoevaluaciÃ³n.  
0.5: realicÃ© 1 actividad completa y la autoevaluaciÃ³n.  
0: no realicÃ© ninguna actividad o no realicÃ© la autoevaluaciÃ³n.  
</Aside>

<Aside type="danger" title="EVIDENCIAS EN BITÃCORA">

1. Realiza las actividades propuestas en esta unidad y documenta todo el proceso en tu bitÃ¡cora.  
2. Realiza la autoevaluaciÃ³n indicando:
    * Tu nota propuesta.
    * La defensa de esa nota para cada actividad. 
</Aside>

## Reflect: ConsolidaciÃ³n y metacogniciÃ³n ğŸ¤”

Para esta fase de pedirÃ© que hagas un diagrama que explique cÃ³mo funciona tu aplicaciÃ³n y 
cÃ³mo se comunican los diferentes componentes.

